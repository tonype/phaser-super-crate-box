<!doctype html> 
<html lang="en"> 
<head> 
	<meta charset="UTF-8" />
    <title>SCB</title>
	<script type="text/javascript" src="js/phaser.min.js"></script>
	<script type="text/javascript" src="js/Player.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

var game = new Phaser.Game(640, 480, Phaser.AUTO, '', { preload: preload, create: create, update: update });

function preload() {
	game.load.image('bullet', 'assets/bullet.png');
	game.load.audio('shoot', ['shoot.mp3','shoot.wav','shoot.ogg']);
	
	player = new Player(game);
	player.preload();
	
	game.load.tilemap('scb', 'assets/scb.json', null, Phaser.Tilemap.TILED_JSON);
	game.load.image('sky', 'assets/sky.png');
	game.load.image('ground', 'assets/platform.png');
	game.load.image('tile', 'assets/tile.png');
	
	game.stage.scale.startFullScreen();
	game.stage.scaleMode = Phaser.StageScaleMode.SHOW_ALL; //resize your window to see the stage resize too
	game.stage.scale.setShowAll();
	game.stage.scale.refresh();
}

var map;
var tileset;
var layer;
var player;

function create() {
	// add background for this level
	game.add.sprite(0, 0, 'sky');
	//this.game.stage.backgroundColor = '#787878';

	map = game.add.tilemap('scb');
	
	map.addTilesetImage('scb_level', 'tile');
	map.setCollision(1, true);
	
	layer = map.createLayer('layer1');
	layer.resizeWorld();
	
	player.create();
}

function update() {
	game.physics.collide(player.sprite, layer);
	game.physics.collide(player.bullets, layer, bulletsTilesCollision);
	player.update();
}

function bulletsTilesCollision(bullet, wall)
{
	bullet.kill();
}
</script>

</body>
</html>